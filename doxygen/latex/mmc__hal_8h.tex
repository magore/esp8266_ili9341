\hypertarget{mmc__hal_8h}{}\section{fatfs/mmc\+\_\+hal.h File Reference}
\label{mmc__hal_8h}\index{fatfs/mmc\+\_\+hal.\+h@{fatfs/mmc\+\_\+hal.\+h}}


M\+MC Hardware Layer for Fat\+Fs.  


{\ttfamily \#include \char`\"{}user\+\_\+config.\+h\char`\"{}}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{mmc__hal_8h_ae150a8179a17d87a2a72bc2d5705d835}{mmc\+\_\+cli}()~cli() /$\ast$$<$ interrupt disable $\ast$/
\item 
\#define \hyperlink{mmc__hal_8h_ae88a5c46f00c634234441978491b16fe}{mmc\+\_\+sei}()~sei() /$\ast$$<$ interrupt enable $\ast$/
\item 
\#define \hyperlink{mmc__hal_8h_aff158a334ad05bff4ddec6d37cee27fb}{mmc\+\_\+disk\+\_\+initialize}~\hyperlink{diskio_8h_a09cdaa6f36fa409bdf002727bff98eb1}{disk\+\_\+initialize}	/$\ast$$<$ \hyperlink{diskio_8h_a09cdaa6f36fa409bdf002727bff98eb1}{disk\+\_\+initialize}() $\ast$/
\item 
\#define \hyperlink{mmc__hal_8h_ae5aaad207550110193363805a79159ee}{mmc\+\_\+disk\+\_\+status}~\hyperlink{diskio_8h_a8348ac5ee6d709420c02e45c111f4793}{disk\+\_\+status}			/$\ast$$<$ \hyperlink{diskio_8h_a8348ac5ee6d709420c02e45c111f4793}{disk\+\_\+status}() $\ast$/
\item 
\#define \hyperlink{mmc__hal_8h_a730cbb43427fc64acf49f9b6c85d6c71}{mmc\+\_\+disk\+\_\+read}~\hyperlink{diskio_8h_a075d27f59f550e2cee07d00abcff32e0}{disk\+\_\+read}             /$\ast$$<$ \hyperlink{diskio_8h_a075d27f59f550e2cee07d00abcff32e0}{disk\+\_\+read}() $\ast$/
\item 
\#define \hyperlink{mmc__hal_8h_a0dbf394d39f84f5e956d77108b3f9787}{mmc\+\_\+disk\+\_\+write}~\hyperlink{diskio_8h_a0fe56ee4831a44b09cfd96856e069634}{disk\+\_\+write}			/$\ast$$<$ \hyperlink{diskio_8h_a075d27f59f550e2cee07d00abcff32e0}{disk\+\_\+read}() $\ast$/
\item 
\#define \hyperlink{mmc__hal_8h_a8ac2eb91d5f4e69388376228678c5912}{mmc\+\_\+disk\+\_\+ioctl}~\hyperlink{diskio_8h_ab00fa450a811dbdabe3c655c1a36fab4}{disk\+\_\+ioctl}           /$\ast$$<$ \hyperlink{diskio_8h_ab00fa450a811dbdabe3c655c1a36fab4}{disk\+\_\+ioctl} $\ast$/
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{user__config_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE} void \hyperlink{mmc__hal_8h_a35434a6e722b07d8fee213c2256391be}{mmc\+\_\+install\+\_\+timer} (void)
\begin{DoxyCompactList}\small\item\em Install M\+MC timer task\+: \hyperlink{mmc__hal_8c_a3371d3911fed5af510a9b6e313773171}{mmc\+\_\+task()} \end{DoxyCompactList}\item 
\hyperlink{user__config_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE} void \hyperlink{mmc__hal_8h_ae417c25675099d771b870e525cd7b124}{mmc\+\_\+spi\+\_\+\+T\+X\+\_\+buffer} (const \hyperlink{send_8c_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$data, int \hyperlink{user__main_8c_aa011065eee776eb1bda73597b5d9d5d7}{count})
\begin{DoxyCompactList}\small\item\em S\+PI write buffer. \end{DoxyCompactList}\item 
\hyperlink{user__config_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE} void \hyperlink{mmc__hal_8h_a4ffe99e5651f10c46f3babc9325ef82f}{mmc\+\_\+spi\+\_\+\+R\+X\+\_\+buffer} (const \hyperlink{send_8c_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$data, int \hyperlink{user__main_8c_aa011065eee776eb1bda73597b5d9d5d7}{count})
\begin{DoxyCompactList}\small\item\em S\+PI read buffer. \end{DoxyCompactList}\item 
\hyperlink{user__config_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE} \hyperlink{send_8c_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{mmc__hal_8h_a8cb914c8127c4bc99546102507e330cc}{mmc\+\_\+spi\+\_\+\+RX} (void)
\begin{DoxyCompactList}\small\item\em S\+PI read 1 byte. \end{DoxyCompactList}\item 
\hyperlink{user__config_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE} void \hyperlink{mmc__hal_8h_acb7cc45118bb7683c9950e0f35f252ce}{mmc\+\_\+spi\+\_\+\+TX} (\hyperlink{send_8c_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} data)
\begin{DoxyCompactList}\small\item\em S\+PI write 1 byte. \end{DoxyCompactList}\item 
\hyperlink{user__config_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE} \hyperlink{send_8c_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{mmc__hal_8h_aef3ff7459eeb9454068bd884c5dcb951}{mmc\+\_\+spi\+\_\+\+T\+X\+RX} (\hyperlink{send_8c_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} data)
\begin{DoxyCompactList}\small\item\em S\+PI read and write 1 byte. \end{DoxyCompactList}\item 
\hyperlink{user__config_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE} void \hyperlink{mmc__hal_8h_a95af3dbb0e5e0a16710138786c29fb4f}{mmc\+\_\+set\+\_\+ms\+\_\+timeout} (\hyperlink{send_8c_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} ms)
\begin{DoxyCompactList}\small\item\em Set M\+MC timeout timer in Milliseconds. \end{DoxyCompactList}\item 
\hyperlink{user__config_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE} int \hyperlink{mmc__hal_8h_a852a35d5ff10bfbe64bcb06ca9a3aeb8}{mmc\+\_\+test\+\_\+timeout} (void)
\begin{DoxyCompactList}\small\item\em Wait for timeout. \end{DoxyCompactList}\item 
\hyperlink{user__config_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE} int \hyperlink{mmc__hal_8h_ad417477e66c88b40dcce683fd6a5c47a}{mmc\+\_\+init} (int verbose)
\begin{DoxyCompactList}\small\item\em Initialize M\+MC and Fat\+Fs interface, display diagnostics. \end{DoxyCompactList}\item 
\hyperlink{user__config_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE} void \hyperlink{mmc__hal_8h_a7c8d13c34124d4ef83ecabc43fbdb8ad}{mmc\+\_\+spi\+\_\+init} (\hyperlink{earth2wireframe_8c_a32f2e37ee053cf2ce8ca28d1f74630e5}{int32\+\_\+t} clock)
\begin{DoxyCompactList}\small\item\em M\+MC S\+PI bus init. \end{DoxyCompactList}\item 
\hyperlink{user__config_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE} void \hyperlink{mmc__hal_8h_a3e75b44ca014c1a21a8ab2e30568da85}{mmc\+\_\+slow} (void)
\begin{DoxyCompactList}\small\item\em M\+MC set slow S\+PI bus speed. \end{DoxyCompactList}\item 
\hyperlink{user__config_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE} void \hyperlink{mmc__hal_8h_a283cf543bfebd952817b5af109c5989e}{mmc\+\_\+fast} (void)
\begin{DoxyCompactList}\small\item\em M\+MC fast S\+PI bus speed. \end{DoxyCompactList}\item 
\hyperlink{user__config_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE} void \hyperlink{mmc__hal_8h_a8b718faa35b9304193cd0c074b542f8a}{mmc\+\_\+power\+\_\+on} (void)
\begin{DoxyCompactList}\small\item\em M\+MC power ON initialize. \end{DoxyCompactList}\item 
\hyperlink{user__config_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE} void \hyperlink{mmc__hal_8h_ac9deae120e9c3b519ea62bf4c486e2ea}{mmc\+\_\+power\+\_\+off} (void)
\begin{DoxyCompactList}\small\item\em M\+MC power off. \end{DoxyCompactList}\item 
\hyperlink{user__config_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE} int \hyperlink{mmc__hal_8h_a7ac4f7882f3b101ffb74878828d30b42}{mmc\+\_\+power\+\_\+status} (void)
\begin{DoxyCompactList}\small\item\em M\+MC power status. \end{DoxyCompactList}\item 
\hyperlink{user__config_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE} void \hyperlink{mmc__hal_8h_a4b1e22f96f354e1014788fc87e30adbf}{mmc\+\_\+cs\+\_\+enable} (void)
\begin{DoxyCompactList}\small\item\em M\+MC CS enable. \end{DoxyCompactList}\item 
\hyperlink{user__config_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE} void \hyperlink{mmc__hal_8h_ac611ee39afca3e8f850c15b95e2a7d80}{mmc\+\_\+cs\+\_\+disable} (void)
\begin{DoxyCompactList}\small\item\em M\+MC CS disable. \end{DoxyCompactList}\item 
\hyperlink{user__config_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE} int \hyperlink{mmc__hal_8h_ab9dae194babcfe774428305a575556cc}{mmc\+\_\+ins\+\_\+status} (void)
\begin{DoxyCompactList}\small\item\em M\+MC Card Inserted status. \end{DoxyCompactList}\item 
\hyperlink{user__config_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE} int \hyperlink{mmc__hal_8h_a5d4cd1450305a6f9ad8ebd1a19a606c5}{mmc\+\_\+wp\+\_\+status} (void)
\begin{DoxyCompactList}\small\item\em M\+MC Card Write Protect status. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
M\+MC Hardware Layer for Fat\+Fs. 

\begin{DoxyParagraph}{Edit History}

\begin{DoxyItemize}
\item \mbox{[}1.\+0\mbox{]} \mbox{[}Mike Gore\mbox{]} Initial revision of file.
\end{DoxyItemize}
\end{DoxyParagraph}
\begin{DoxyParagraph}{Copyright \copyright{} 2014 Mike Gore, Inc. All rights reserved.}

\end{DoxyParagraph}


\subsection{Macro Definition Documentation}
\index{mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}!mmc\+\_\+cli@{mmc\+\_\+cli}}
\index{mmc\+\_\+cli@{mmc\+\_\+cli}!mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}}
\subsubsection[{\texorpdfstring{mmc\+\_\+cli}{mmc_cli}}]{\setlength{\rightskip}{0pt plus 5cm}\#define mmc\+\_\+cli(
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)~cli() /$\ast$$<$ interrupt disable $\ast$/}\hypertarget{mmc__hal_8h_ae150a8179a17d87a2a72bc2d5705d835}{}\label{mmc__hal_8h_ae150a8179a17d87a2a72bc2d5705d835}


Definition at line 35 of file mmc\+\_\+hal.\+h.



Referenced by mmc\+\_\+set\+\_\+ms\+\_\+timeout().

\index{mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}!mmc\+\_\+disk\+\_\+initialize@{mmc\+\_\+disk\+\_\+initialize}}
\index{mmc\+\_\+disk\+\_\+initialize@{mmc\+\_\+disk\+\_\+initialize}!mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}}
\subsubsection[{\texorpdfstring{mmc\+\_\+disk\+\_\+initialize}{mmc_disk_initialize}}]{\setlength{\rightskip}{0pt plus 5cm}\#define mmc\+\_\+disk\+\_\+initialize~{\bf disk\+\_\+initialize}	/$\ast$$<$ {\bf disk\+\_\+initialize}() $\ast$/}\hypertarget{mmc__hal_8h_aff158a334ad05bff4ddec6d37cee27fb}{}\label{mmc__hal_8h_aff158a334ad05bff4ddec6d37cee27fb}


Definition at line 39 of file mmc\+\_\+hal.\+h.

\index{mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}!mmc\+\_\+disk\+\_\+ioctl@{mmc\+\_\+disk\+\_\+ioctl}}
\index{mmc\+\_\+disk\+\_\+ioctl@{mmc\+\_\+disk\+\_\+ioctl}!mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}}
\subsubsection[{\texorpdfstring{mmc\+\_\+disk\+\_\+ioctl}{mmc_disk_ioctl}}]{\setlength{\rightskip}{0pt plus 5cm}\#define mmc\+\_\+disk\+\_\+ioctl~{\bf disk\+\_\+ioctl}           /$\ast$$<$ {\bf disk\+\_\+ioctl} $\ast$/}\hypertarget{mmc__hal_8h_a8ac2eb91d5f4e69388376228678c5912}{}\label{mmc__hal_8h_a8ac2eb91d5f4e69388376228678c5912}


Definition at line 43 of file mmc\+\_\+hal.\+h.



Referenced by mmc\+\_\+init().

\index{mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}!mmc\+\_\+disk\+\_\+read@{mmc\+\_\+disk\+\_\+read}}
\index{mmc\+\_\+disk\+\_\+read@{mmc\+\_\+disk\+\_\+read}!mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}}
\subsubsection[{\texorpdfstring{mmc\+\_\+disk\+\_\+read}{mmc_disk_read}}]{\setlength{\rightskip}{0pt plus 5cm}\#define mmc\+\_\+disk\+\_\+read~{\bf disk\+\_\+read}             /$\ast$$<$ {\bf disk\+\_\+read}() $\ast$/}\hypertarget{mmc__hal_8h_a730cbb43427fc64acf49f9b6c85d6c71}{}\label{mmc__hal_8h_a730cbb43427fc64acf49f9b6c85d6c71}


Definition at line 41 of file mmc\+\_\+hal.\+h.

\index{mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}!mmc\+\_\+disk\+\_\+status@{mmc\+\_\+disk\+\_\+status}}
\index{mmc\+\_\+disk\+\_\+status@{mmc\+\_\+disk\+\_\+status}!mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}}
\subsubsection[{\texorpdfstring{mmc\+\_\+disk\+\_\+status}{mmc_disk_status}}]{\setlength{\rightskip}{0pt plus 5cm}\#define mmc\+\_\+disk\+\_\+status~{\bf disk\+\_\+status}			/$\ast$$<$ {\bf disk\+\_\+status}() $\ast$/}\hypertarget{mmc__hal_8h_ae5aaad207550110193363805a79159ee}{}\label{mmc__hal_8h_ae5aaad207550110193363805a79159ee}


Definition at line 40 of file mmc\+\_\+hal.\+h.

\index{mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}!mmc\+\_\+disk\+\_\+write@{mmc\+\_\+disk\+\_\+write}}
\index{mmc\+\_\+disk\+\_\+write@{mmc\+\_\+disk\+\_\+write}!mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}}
\subsubsection[{\texorpdfstring{mmc\+\_\+disk\+\_\+write}{mmc_disk_write}}]{\setlength{\rightskip}{0pt plus 5cm}\#define mmc\+\_\+disk\+\_\+write~{\bf disk\+\_\+write}			/$\ast$$<$ {\bf disk\+\_\+read}() $\ast$/}\hypertarget{mmc__hal_8h_a0dbf394d39f84f5e956d77108b3f9787}{}\label{mmc__hal_8h_a0dbf394d39f84f5e956d77108b3f9787}


Definition at line 42 of file mmc\+\_\+hal.\+h.

\index{mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}!mmc\+\_\+sei@{mmc\+\_\+sei}}
\index{mmc\+\_\+sei@{mmc\+\_\+sei}!mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}}
\subsubsection[{\texorpdfstring{mmc\+\_\+sei}{mmc_sei}}]{\setlength{\rightskip}{0pt plus 5cm}\#define mmc\+\_\+sei(
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)~sei() /$\ast$$<$ interrupt enable $\ast$/}\hypertarget{mmc__hal_8h_ae88a5c46f00c634234441978491b16fe}{}\label{mmc__hal_8h_ae88a5c46f00c634234441978491b16fe}


Definition at line 36 of file mmc\+\_\+hal.\+h.



Referenced by mmc\+\_\+set\+\_\+ms\+\_\+timeout().



\subsection{Function Documentation}
\index{mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}!mmc\+\_\+cs\+\_\+disable@{mmc\+\_\+cs\+\_\+disable}}
\index{mmc\+\_\+cs\+\_\+disable@{mmc\+\_\+cs\+\_\+disable}!mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}}
\subsubsection[{\texorpdfstring{mmc\+\_\+cs\+\_\+disable(void)}{mmc_cs_disable(void)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\+E\+M\+S\+P\+A\+CE} void mmc\+\_\+cs\+\_\+disable (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{mmc__hal_8h_ac611ee39afca3e8f850c15b95e2a7d80}{}\label{mmc__hal_8h_ac611ee39afca3e8f850c15b95e2a7d80}


M\+MC CS disable. 


\begin{DoxyItemize}
\item M\+MC S\+PI chip select \begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}

\end{DoxyItemize}

Definition at line 390 of file mmc\+\_\+hal.\+c.



Referenced by mmc\+\_\+deselect().

\index{mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}!mmc\+\_\+cs\+\_\+enable@{mmc\+\_\+cs\+\_\+enable}}
\index{mmc\+\_\+cs\+\_\+enable@{mmc\+\_\+cs\+\_\+enable}!mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}}
\subsubsection[{\texorpdfstring{mmc\+\_\+cs\+\_\+enable(void)}{mmc_cs_enable(void)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\+E\+M\+S\+P\+A\+CE} void mmc\+\_\+cs\+\_\+enable (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{mmc__hal_8h_a4b1e22f96f354e1014788fc87e30adbf}{}\label{mmc__hal_8h_a4b1e22f96f354e1014788fc87e30adbf}


M\+MC CS enable. 


\begin{DoxyItemize}
\item M\+MC S\+PI chip select \begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}

\end{DoxyItemize}

Definition at line 372 of file mmc\+\_\+hal.\+c.



Referenced by mmc\+\_\+select().

\index{mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}!mmc\+\_\+fast@{mmc\+\_\+fast}}
\index{mmc\+\_\+fast@{mmc\+\_\+fast}!mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}}
\subsubsection[{\texorpdfstring{mmc\+\_\+fast(void)}{mmc_fast(void)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\+E\+M\+S\+P\+A\+CE} void mmc\+\_\+fast (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{mmc__hal_8h_a283cf543bfebd952817b5af109c5989e}{}\label{mmc__hal_8h_a283cf543bfebd952817b5af109c5989e}


M\+MC fast S\+PI bus speed. 


\begin{DoxyItemize}
\item Used during normal file IO phases \begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}

\end{DoxyItemize}

Definition at line 309 of file mmc\+\_\+hal.\+c.



Referenced by mmc\+\_\+disk\+\_\+initialize().

\index{mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}!mmc\+\_\+init@{mmc\+\_\+init}}
\index{mmc\+\_\+init@{mmc\+\_\+init}!mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}}
\subsubsection[{\texorpdfstring{mmc\+\_\+init(int verbose)}{mmc_init(int verbose)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\+E\+M\+S\+P\+A\+CE} int mmc\+\_\+init (
\begin{DoxyParamCaption}
\item[{int}]{verbose}
\end{DoxyParamCaption}
)}\hypertarget{mmc__hal_8h_ad417477e66c88b40dcce683fd6a5c47a}{}\label{mmc__hal_8h_ad417477e66c88b40dcce683fd6a5c47a}


Initialize M\+MC and Fat\+Fs interface, display diagnostics. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em verbose} & display initialisation messages \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}

\end{DoxyReturn}


Definition at line 195 of file mmc\+\_\+hal.\+c.



Referenced by fatfs\+\_\+tests(), open(), and setup().

\index{mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}!mmc\+\_\+ins\+\_\+status@{mmc\+\_\+ins\+\_\+status}}
\index{mmc\+\_\+ins\+\_\+status@{mmc\+\_\+ins\+\_\+status}!mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}}
\subsubsection[{\texorpdfstring{mmc\+\_\+ins\+\_\+status(void)}{mmc_ins_status(void)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\+E\+M\+S\+P\+A\+CE} int mmc\+\_\+ins\+\_\+status (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{mmc__hal_8h_ab9dae194babcfe774428305a575556cc}{}\label{mmc__hal_8h_ab9dae194babcfe774428305a575556cc}


M\+MC Card Inserted status. 


\begin{DoxyItemize}
\item We do not detect card insert status in this project. \begin{DoxyReturn}{Returns}
1 card inserted 
\end{DoxyReturn}

\end{DoxyItemize}

Definition at line 406 of file mmc\+\_\+hal.\+c.



Referenced by mmc\+\_\+task().

\index{mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}!mmc\+\_\+install\+\_\+timer@{mmc\+\_\+install\+\_\+timer}}
\index{mmc\+\_\+install\+\_\+timer@{mmc\+\_\+install\+\_\+timer}!mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}}
\subsubsection[{\texorpdfstring{mmc\+\_\+install\+\_\+timer(void)}{mmc_install_timer(void)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\+E\+M\+S\+P\+A\+CE} void mmc\+\_\+install\+\_\+timer (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{mmc__hal_8h_a35434a6e722b07d8fee213c2256391be}{}\label{mmc__hal_8h_a35434a6e722b07d8fee213c2256391be}


Install M\+MC timer task\+: \hyperlink{mmc__hal_8c_a3371d3911fed5af510a9b6e313773171}{mmc\+\_\+task()} 

\begin{DoxySeeAlso}{See also}
\hyperlink{mmc__hal_8c_a3371d3911fed5af510a9b6e313773171}{mmc\+\_\+task()} 
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 74 of file mmc\+\_\+hal.\+c.



Referenced by mmc\+\_\+init().

\index{mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}!mmc\+\_\+power\+\_\+off@{mmc\+\_\+power\+\_\+off}}
\index{mmc\+\_\+power\+\_\+off@{mmc\+\_\+power\+\_\+off}!mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}}
\subsubsection[{\texorpdfstring{mmc\+\_\+power\+\_\+off(void)}{mmc_power_off(void)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\+E\+M\+S\+P\+A\+CE} void mmc\+\_\+power\+\_\+off (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{mmc__hal_8h_ac9deae120e9c3b519ea62bf4c486e2ea}{}\label{mmc__hal_8h_ac9deae120e9c3b519ea62bf4c486e2ea}


M\+MC power off. 


\begin{DoxyItemize}
\item We do not control power to the M\+MC device in this project. \begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}

\end{DoxyItemize}

Definition at line 343 of file mmc\+\_\+hal.\+c.



Referenced by mmc\+\_\+disk\+\_\+initialize(), and mmc\+\_\+disk\+\_\+ioctl().

\index{mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}!mmc\+\_\+power\+\_\+on@{mmc\+\_\+power\+\_\+on}}
\index{mmc\+\_\+power\+\_\+on@{mmc\+\_\+power\+\_\+on}!mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}}
\subsubsection[{\texorpdfstring{mmc\+\_\+power\+\_\+on(void)}{mmc_power_on(void)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\+E\+M\+S\+P\+A\+CE} void mmc\+\_\+power\+\_\+on (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{mmc__hal_8h_a8b718faa35b9304193cd0c074b542f8a}{}\label{mmc__hal_8h_a8b718faa35b9304193cd0c074b542f8a}


M\+MC power ON initialize. 


\begin{DoxyItemize}
\item We do not control power to the M\+MC device in this project. \begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}

\end{DoxyItemize}

Definition at line 320 of file mmc\+\_\+hal.\+c.



Referenced by mmc\+\_\+disk\+\_\+initialize().

\index{mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}!mmc\+\_\+power\+\_\+status@{mmc\+\_\+power\+\_\+status}}
\index{mmc\+\_\+power\+\_\+status@{mmc\+\_\+power\+\_\+status}!mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}}
\subsubsection[{\texorpdfstring{mmc\+\_\+power\+\_\+status(void)}{mmc_power_status(void)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\+E\+M\+S\+P\+A\+CE} int mmc\+\_\+power\+\_\+status (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{mmc__hal_8h_a7ac4f7882f3b101ffb74878828d30b42}{}\label{mmc__hal_8h_a7ac4f7882f3b101ffb74878828d30b42}


M\+MC power status. 


\begin{DoxyItemize}
\item We do not control power to the M\+MC device in this project. \begin{DoxyReturn}{Returns}
1 power is alwasy on 
\end{DoxyReturn}

\end{DoxyItemize}

Definition at line 360 of file mmc\+\_\+hal.\+c.

\index{mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}!mmc\+\_\+set\+\_\+ms\+\_\+timeout@{mmc\+\_\+set\+\_\+ms\+\_\+timeout}}
\index{mmc\+\_\+set\+\_\+ms\+\_\+timeout@{mmc\+\_\+set\+\_\+ms\+\_\+timeout}!mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}}
\subsubsection[{\texorpdfstring{mmc\+\_\+set\+\_\+ms\+\_\+timeout(uint16\+\_\+t ms)}{mmc_set_ms_timeout(uint16_t ms)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\+E\+M\+S\+P\+A\+CE} void mmc\+\_\+set\+\_\+ms\+\_\+timeout (
\begin{DoxyParamCaption}
\item[{{\bf uint16\+\_\+t}}]{ms}
\end{DoxyParamCaption}
)}\hypertarget{mmc__hal_8h_a95af3dbb0e5e0a16710138786c29fb4f}{}\label{mmc__hal_8h_a95af3dbb0e5e0a16710138786c29fb4f}


Set M\+MC timeout timer in Milliseconds. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em ms} & timeout in Milliseconds\\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See also}
\hyperlink{mmc__hal_8c_a7383533f1b6630ff4f0337f400b4b62e}{mmc\+\_\+test\+\_\+timeout} ( ) 
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 159 of file mmc\+\_\+hal.\+c.



Referenced by mmc\+\_\+disk\+\_\+initialize(), rcvr\+\_\+datablock(), and wait\+\_\+ready().

\index{mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}!mmc\+\_\+slow@{mmc\+\_\+slow}}
\index{mmc\+\_\+slow@{mmc\+\_\+slow}!mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}}
\subsubsection[{\texorpdfstring{mmc\+\_\+slow(void)}{mmc_slow(void)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\+E\+M\+S\+P\+A\+CE} void mmc\+\_\+slow (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{mmc__hal_8h_a3e75b44ca014c1a21a8ab2e30568da85}{}\label{mmc__hal_8h_a3e75b44ca014c1a21a8ab2e30568da85}


M\+MC set slow S\+PI bus speed. 


\begin{DoxyItemize}
\item Used during card detect phase \begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}

\end{DoxyItemize}

Definition at line 297 of file mmc\+\_\+hal.\+c.



Referenced by mmc\+\_\+disk\+\_\+initialize(), mmc\+\_\+init(), and mmc\+\_\+power\+\_\+on().

\index{mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}!mmc\+\_\+spi\+\_\+init@{mmc\+\_\+spi\+\_\+init}}
\index{mmc\+\_\+spi\+\_\+init@{mmc\+\_\+spi\+\_\+init}!mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}}
\subsubsection[{\texorpdfstring{mmc\+\_\+spi\+\_\+init(int32\+\_\+t clock)}{mmc_spi_init(int32_t clock)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\+E\+M\+S\+P\+A\+CE} void mmc\+\_\+spi\+\_\+init (
\begin{DoxyParamCaption}
\item[{{\bf int32\+\_\+t}}]{clock}
\end{DoxyParamCaption}
)}\hypertarget{mmc__hal_8h_a7c8d13c34124d4ef83ecabc43fbdb8ad}{}\label{mmc__hal_8h_a7c8d13c34124d4ef83ecabc43fbdb8ad}


M\+MC S\+PI bus init. 

\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 275 of file mmc\+\_\+hal.\+c.



Referenced by mmc\+\_\+cs\+\_\+enable(), mmc\+\_\+fast(), and mmc\+\_\+slow().

\index{mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}!mmc\+\_\+spi\+\_\+\+RX@{mmc\+\_\+spi\+\_\+\+RX}}
\index{mmc\+\_\+spi\+\_\+\+RX@{mmc\+\_\+spi\+\_\+\+RX}!mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}}
\subsubsection[{\texorpdfstring{mmc\+\_\+spi\+\_\+\+R\+X(void)}{mmc_spi_RX(void)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\+E\+M\+S\+P\+A\+CE} {\bf uint8\+\_\+t} mmc\+\_\+spi\+\_\+\+RX (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{mmc__hal_8h_a8cb914c8127c4bc99546102507e330cc}{}\label{mmc__hal_8h_a8cb914c8127c4bc99546102507e330cc}


S\+PI read 1 byte. 

\begin{DoxyReturn}{Returns}
uint8\+\_\+t value 
\end{DoxyReturn}


Definition at line 112 of file mmc\+\_\+hal.\+c.

\index{mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}!mmc\+\_\+spi\+\_\+\+R\+X\+\_\+buffer@{mmc\+\_\+spi\+\_\+\+R\+X\+\_\+buffer}}
\index{mmc\+\_\+spi\+\_\+\+R\+X\+\_\+buffer@{mmc\+\_\+spi\+\_\+\+R\+X\+\_\+buffer}!mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}}
\subsubsection[{\texorpdfstring{mmc\+\_\+spi\+\_\+\+R\+X\+\_\+buffer(const uint8\+\_\+t $\ast$data, int count)}{mmc_spi_RX_buffer(const uint8_t *data, int count)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\+E\+M\+S\+P\+A\+CE} void mmc\+\_\+spi\+\_\+\+R\+X\+\_\+buffer (
\begin{DoxyParamCaption}
\item[{const {\bf uint8\+\_\+t} $\ast$}]{data, }
\item[{int}]{count}
\end{DoxyParamCaption}
)}\hypertarget{mmc__hal_8h_a4ffe99e5651f10c46f3babc9325ef82f}{}\label{mmc__hal_8h_a4ffe99e5651f10c46f3babc9325ef82f}


S\+PI read buffer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em $\ast$data} & transmit buffer \\
\hline
\mbox{\tt in}  & {\em count} & number of bytes to write \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 100 of file mmc\+\_\+hal.\+c.



Referenced by rcvr\+\_\+datablock().

\index{mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}!mmc\+\_\+spi\+\_\+\+TX@{mmc\+\_\+spi\+\_\+\+TX}}
\index{mmc\+\_\+spi\+\_\+\+TX@{mmc\+\_\+spi\+\_\+\+TX}!mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}}
\subsubsection[{\texorpdfstring{mmc\+\_\+spi\+\_\+\+T\+X(uint8\+\_\+t data)}{mmc_spi_TX(uint8_t data)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\+E\+M\+S\+P\+A\+CE} void mmc\+\_\+spi\+\_\+\+TX (
\begin{DoxyParamCaption}
\item[{{\bf uint8\+\_\+t}}]{data}
\end{DoxyParamCaption}
)}\hypertarget{mmc__hal_8h_acb7cc45118bb7683c9950e0f35f252ce}{}\label{mmc__hal_8h_acb7cc45118bb7683c9950e0f35f252ce}


S\+PI write 1 byte. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & value to transmit \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 127 of file mmc\+\_\+hal.\+c.



Referenced by mmc\+\_\+deselect(), mmc\+\_\+disk\+\_\+initialize(), mmc\+\_\+disk\+\_\+ioctl(), mmc\+\_\+power\+\_\+off(), mmc\+\_\+select(), mmc\+\_\+spi\+\_\+init(), rcvr\+\_\+datablock(), send\+\_\+cmd(), and xmit\+\_\+datablock().

\index{mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}!mmc\+\_\+spi\+\_\+\+T\+X\+\_\+buffer@{mmc\+\_\+spi\+\_\+\+T\+X\+\_\+buffer}}
\index{mmc\+\_\+spi\+\_\+\+T\+X\+\_\+buffer@{mmc\+\_\+spi\+\_\+\+T\+X\+\_\+buffer}!mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}}
\subsubsection[{\texorpdfstring{mmc\+\_\+spi\+\_\+\+T\+X\+\_\+buffer(const uint8\+\_\+t $\ast$data, int count)}{mmc_spi_TX_buffer(const uint8_t *data, int count)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\+E\+M\+S\+P\+A\+CE} void mmc\+\_\+spi\+\_\+\+T\+X\+\_\+buffer (
\begin{DoxyParamCaption}
\item[{const {\bf uint8\+\_\+t} $\ast$}]{data, }
\item[{int}]{count}
\end{DoxyParamCaption}
)}\hypertarget{mmc__hal_8h_ae417c25675099d771b870e525cd7b124}{}\label{mmc__hal_8h_ae417c25675099d771b870e525cd7b124}


S\+PI write buffer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em $\ast$data} & transmit buffer \\
\hline
\mbox{\tt in}  & {\em count} & number of bytes to write \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 86 of file mmc\+\_\+hal.\+c.



Referenced by xmit\+\_\+datablock().

\index{mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}!mmc\+\_\+spi\+\_\+\+T\+X\+RX@{mmc\+\_\+spi\+\_\+\+T\+X\+RX}}
\index{mmc\+\_\+spi\+\_\+\+T\+X\+RX@{mmc\+\_\+spi\+\_\+\+T\+X\+RX}!mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}}
\subsubsection[{\texorpdfstring{mmc\+\_\+spi\+\_\+\+T\+X\+R\+X(uint8\+\_\+t data)}{mmc_spi_TXRX(uint8_t data)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\+E\+M\+S\+P\+A\+CE} {\bf uint8\+\_\+t} mmc\+\_\+spi\+\_\+\+T\+X\+RX (
\begin{DoxyParamCaption}
\item[{{\bf uint8\+\_\+t}}]{data}
\end{DoxyParamCaption}
)}\hypertarget{mmc__hal_8h_aef3ff7459eeb9454068bd884c5dcb951}{}\label{mmc__hal_8h_aef3ff7459eeb9454068bd884c5dcb951}


S\+PI read and write 1 byte. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & value to transmit \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
uint8\+\_\+t value read 
\end{DoxyReturn}


Definition at line 141 of file mmc\+\_\+hal.\+c.



Referenced by mmc\+\_\+disk\+\_\+initialize(), mmc\+\_\+disk\+\_\+ioctl(), rcvr\+\_\+datablock(), send\+\_\+cmd(), wait\+\_\+ready(), and xmit\+\_\+datablock().

\index{mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}!mmc\+\_\+test\+\_\+timeout@{mmc\+\_\+test\+\_\+timeout}}
\index{mmc\+\_\+test\+\_\+timeout@{mmc\+\_\+test\+\_\+timeout}!mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}}
\subsubsection[{\texorpdfstring{mmc\+\_\+test\+\_\+timeout(void)}{mmc_test_timeout(void)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\+E\+M\+S\+P\+A\+CE} int mmc\+\_\+test\+\_\+timeout (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{mmc__hal_8h_a852a35d5ff10bfbe64bcb06ca9a3aeb8}{}\label{mmc__hal_8h_a852a35d5ff10bfbe64bcb06ca9a3aeb8}


Wait for timeout. 

\begin{DoxyReturn}{Returns}
1 ready 

0 timeout 
\end{DoxyReturn}


Definition at line 170 of file mmc\+\_\+hal.\+c.



Referenced by mmc\+\_\+disk\+\_\+initialize(), rcvr\+\_\+datablock(), and wait\+\_\+ready().

\index{mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}!mmc\+\_\+wp\+\_\+status@{mmc\+\_\+wp\+\_\+status}}
\index{mmc\+\_\+wp\+\_\+status@{mmc\+\_\+wp\+\_\+status}!mmc\+\_\+hal.\+h@{mmc\+\_\+hal.\+h}}
\subsubsection[{\texorpdfstring{mmc\+\_\+wp\+\_\+status(void)}{mmc_wp_status(void)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\+E\+M\+S\+P\+A\+CE} int mmc\+\_\+wp\+\_\+status (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{mmc__hal_8h_a5d4cd1450305a6f9ad8ebd1a19a606c5}{}\label{mmc__hal_8h_a5d4cd1450305a6f9ad8ebd1a19a606c5}


M\+MC Card Write Protect status. 


\begin{DoxyItemize}
\item We do not detect card write protect status in this project. \begin{DoxyReturn}{Returns}
0 == not write protected 
\end{DoxyReturn}

\end{DoxyItemize}

Definition at line 419 of file mmc\+\_\+hal.\+c.



Referenced by mmc\+\_\+task().

